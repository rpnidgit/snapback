#!/usr/bin/env bash
# Stolen from btrfs-assistant
#
# This wrapper allows some enviroment variables to be (re-)set properlyt.

ID=$(id -u)
if [[ "$ID" == "0" ]]; then
  export XDG_RUNTIME_DIR=$(mktemp -d)
fi

# extract and set display env. values from passed args, and put all others in params
for i in "$@"; do
  case $i in
    -x=*|--xdg-desktop=*)
      export XDG_CURRENT_DESKTOP="${i#*=}"
      shift
      ;;
    -r=*|--xdg-runtime=*)
      export XDG_RUNTIME_DIR="${i#*=}"
      shift
      ;;
    -t=*|--platformtheme=*)
      export QT_QPA_PLATFORMTHEME="${i#*=}"
      shift
      ;;
    -p=*|--platform=*)
      export QT_QPA_PLATFORM="${i#*=}"
      shift
      ;;
    -d=*|--display=*)
      export WAYLAND_DISPLAY="${i#*=}"
      shift
      ;;
    *)
      params="${params} ${i}"
      shift
      ;;
  esac
done

vorta ${params}
#EOF
